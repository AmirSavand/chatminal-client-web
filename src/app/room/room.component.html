<div class="wrapper" *ngIf="room">

  <!-- Header -->
  <div class="header">
    <div class="fw-bold me-auto">Room <span class="font-monospace">{{ room.id }}</span></div>
    <a class="text-secondary" *ngIf="members" (click)="showMembers()" title="Click to show members">
      <span class="me-1">{{ members.count | number }}</span>
      <fa-icon [fixedWidth]="true" [icon]="faUsers"></fa-icon>
    </a>
    <a class="ms-3 text-secondary" *ngIf="view === 'chats'" (click)="view = 'settings'">
      <fa-icon [fixedWidth]="true" [icon]="faSettings"></fa-icon>
    </a>
  </div>

  <!-- View -->
  <div class="view" #viewElement>

    <!-- View: Chats -->
    <ng-container *ngIf="view === 'chats'">
      <div class="chat" *ngFor="let chat of messages">
        <div class="user"
             [class.text-primary]="chat.user === 'Chatminal'"
             [class.text-info]="chat.user === user.username">
          {{ chat.user }}
        </div>
        <div class="message">{{ chat.message }}</div>
      </div>
    </ng-container>

    <!-- View: Settings -->
    <div class="terminal m-5" *ngIf="view === 'settings'">
      <div>
        <span class="sign">&#62;</span>
        <span class="text-white">Room Settings</span>
      </div>
      <div>
        <span class="sign">&#62;</span>
        <span>Room ID is {{ room.id }}</span>
      </div>
      <div>
        <span class="sign">&#62;</span>
        <span *ngIf="members">Your connection is <span class="text-success">OK</span></span>
        <span *ngIf="!members">Your connection is <span class="text-danger">NOT OK</span></span>
      </div>
      <div *ngIf="members">
        <span class="sign">&#62;</span>
        <span>{{ members.count | number }} number of online members</span>
      </div>
      <div>
        <span class="sign">&#62;</span>
        <button (click)="remove()">Leave Room</button>
      </div>
      <div>
        <span class="sign">&#62;</span>
        <button (click)="view = 'chats'">Go Back</button>
      </div>
    </div>
  </div>

  <!-- Chatbox -->
  <form class="chatbox" *ngIf="view === 'chats' && members" (ngSubmit)="submit()">
    <input type="text" class="chatbox" placeholder="Message"
           [ngModelOptions]="{ standalone: true }"
           [(ngModel)]="input">
  </form>
</div>
